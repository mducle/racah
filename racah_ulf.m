function ulf = racah_ulf(U,L,Up,Lp)
% Looks up the value of the racah function (UL|U'L'+f) from tables
% Tables from Racah IV, Phys. Rev. 76 (1949) 1352 for tableIV (t1,t2,t3)
% and from Wybourne, J. Chem. Phys. 36 (1961) 2295 for table IIb-c (t4,t5)

if isnumeric(L)
  L = racah_lconv(L);
end

if isnumeric(Lp)
  Lp = racah_lconv(Lp);
end

% U' (00)     (10)         (11)                   (20)                                     (21)                                    L  U
% L'  S        F        P        H        D        G        I          D        F        G        H        K        L
t1 = [0       -1        0        0        0        0        0          0        0        0        0        0        0;           % S (00)
      1        1       3/14    11/14    -5/27    -1/3    -13/27        0        0        0        0        0        0;           % F (10)
      0        1        0        0      10/21   -11/21      0       [220     -539     -585        0        0        0] ./ 1344;  % P (11)
      0        1        0        0      20/189   65/231 -182/297   [-270      147     -297     1078     1470    -1666] ./ 4928;  % H
      0        1     -27/49   -22/49   -16/49    33/49      0      [8910     8085      351   -14014        0        0] ./ 31360; % D (20)
      0        1      33/98   -65/98    55/147 -125/539   13/33     [330      147     1287     1078    -1470        0] ./ 4312;  % G
      0        1        0        1        0       3/11     8/11       [0    -1911     1485      220     4590    10098] ./ 18304; % I
      0        0     -22/49    27/49    33/49    16/49      0       [375     1960    -1144     1911        0        0] ./ 5390;  % D (21)
      0        0     -11/14     3/14   -55/126   -8/77    91/198    [-40       49      -65        0        0        0] ./ 154;   % F
      0        0      65/98    33/98    13/882  104/147    5/18  [-74360   207025   226941   -51744    70560        0] ./ 630630;% G
      0        0        0        1      13/27   -16/33   -10/297  [-2535        0     1056    -3179     7260     1700] ./ 15730; % H
      0        0        0        1        0      16/33   -17/33       [0        0     -192      968      -85     1615] ./ 2860;  % K
      0        0        0        1        0        0        1         [0        0        0      -40     -285      247] ./ 572;   % L
      0        0        0        0      11/21    10/21      0      [1156     -245     1287        0        0        0] ./ 2688;  % P (30)
      0        0        0        0     143/378 -130/231   35/594    [-39        0       24       49        0        0] ./ 112;   % F
      0        0        0        0      11/18     2/33   -65/198   [1375     2450     -858     1617     1620        0] ./ 7920;  % G
      0        0        0        0      26/63    18/77    35/99  [-42250  -207025     3971   261954      490   124950] ./ 640640;% H
      0        0        0        0        0       8/11    -3/11       [0     1274     2750     1320     2125    -1683] ./ 9152;  % I
      0        0        0        0        0      17/33    16/33       [0        0     -204     -136      605       95] ./ 1040;  % K
      0        0        0        0        0        0        1         [0        0        0        0      -15      -49] ./ 64;    % M
      0        0        0        0        0        0        0         [0        1        0        0        0        0] ./ 1;     % S (22)
      0        0        0        0        0        0        0      [-130      195      297       18        0        0] ./ 640;   % D
      0        0        0        0        0        0        0     [18590     4225     -429   -23826    -4410        0] ./ 51480; % G
      0        0        0        0        0        0        0       [980    -2450     1078     -132      245    -1275] ./ 6160;  % H
      0        0        0        0        0        0        0         [0     1105     9163    -2244    -4802      990] ./ 18304; % I
      0        0        0        0        0        0        0         [0        0        0      152     -147      -65] ./ 364;   % L
      0        0        0        0        0        0        0         [0        0        0        0       -5       11] ./ 16];   % N
%  ^------------------- Racah IV, table IVa --------------------^  ^----------------- Racah IV, table IVb ---------------^

%  .--------------------- Table IVc, from Racah IV --------------------.
% U'                               (30)                                          L  U
% L'      P        F        G        H        I        K        M
t3 = [ [-54      -91      189     -156        0        0        0] ./ 490;     % D (20)
      [-330      910      126     -594     2184    -1785        0] ./ 5929;    % G
         [0     -245    -1755    -2310    -2106    -4320   -11286] ./ 22022;   % I
      [-578     1092      700      325        0        0        0] ./ 2695;    % D (21)
       [-55        0     -560     -715     -364        0        0] ./ 1694;    % F
    [-83655   -87360   -56784    -3971   227500   171360        0] ./ 630630;  % G
         [0    12740    -7644    18711    -7800    -8160        0] ./ 55055;   % H
         [0        0   -16848       77   -27625    79860   -40755] ./ 165165;  % K
         [0        0        0    -1785    -1989    -1140    12103] ./ 17017;   % L
         [0       13        3        0        0        0        0] ./ 16;      % P (30)
       [429      -77      273      -33     -420        0        0] ./ 1232;    % F
     [-3465    -9555     7203    27797     1300    -6120        0] ./ 55440;   % G
         [0     -195    -4693     1232     2600     2720        0] ./ 11440;   % H
         [0     5880      520    -6160    -1911    15680    -1881] ./ 32032;   % I
         [0        0    33813    89012  -216580     8085   163020] ./ 510510;  % K
         [0        0        0        0      153      960     2695] ./ 3808];   % M

% Table IIb from Wybourne, J. Chem. Phys. 36 (1961) 2295, modified by numbers from ACRY program of Allison
% U'=(21) D        F        G        H        K        L                         U=(31)
t4 = [  [52       65      -11        0        0        0] ./ 128;              % P
       [156      -26      110       60        0        0] ./ 352;              % D
         [8       45       13        0        0        0] ./ 66;               % F
        [26        0      -16       54        0        0] ./ 96;               % F'
      [9295    -8450     7722      -33     8820        0] ./ 34320;            % G
    [258570    71825    22627    54978    74970    66150] ./ 549120;           % H
   [-745290  1002001  5498339   411906  -533610  -265302] ./ 8456448;          % H'
         [0     6370    -1078   222024   -67473    23375] ./ 320320;           % I
         [0    54145    -9163    -2244     3528    11000] ./ 80080             % I'
         [0        0    63308  -937992  -349125   491415] ./ 1841840;          % K
         [0        0     2940       90      833      323] ./ 4186;             % K'
         [0        0        0      513       98      390] ./ 1001;             % L
         [0        0        0        0       49      -15] ./ 64;               % M
         [0        0        0        0       11        5] ./ 16;               % N
         [0        0        0        0        0        1] ./ 1];               % O
%------------------------------------------------------------------------------%
%        [0     2080     -352     1056     -153      935] ./ 4576;             % I
%        [0     4420     -748    -8976     4050      110] ./ 18304;            % I'
%        [0        0   341164   -55176     4845   159375] ./ 560560;           % K
%        [0        0      816     2754     2420     -380] ./ 6370;             % K'
%------------------------- Original entries of Wybourne -----------------------%

% NB. The numbers for the original tables of Wybourne are consistent amongst themselves,
%     but if their reciprocal is taken complete the entries in tables acry1 and acry2 below,
%     those entries will not satisfy the orthonormality conditions. Hence we use instead the
%     numbers from Allison's ACRY program, derived by P.B. Nutter.

% Table IIc from Wybourne, J. Chem. Phys. 36 (1961) 2295, modified by numbers from ACRY program of Allison
% U'=(30) P        F        G        H        I        K        M                U=(31)
t5 = [   [0       -3       13        0        0        0        0] ./ 16;      % P
      [-936    -1029      -91     1024        0        0        0] ./ 3080;    % D
       [-99        0      700    -1287      455        0        0] ./ 2541;    % F
      [1287     2079      -91      -99      140        0        0] ./ 3696;    % F'
    [-83655    66885    31941     5819    -9100    42840        0] ./ 240240;  % G
         [0    -3315   -26741   -20944        0   -17640        0] ./ 68640;   % H 
         [0   238875    31213    -1232   632736  -153000        0] ./ 1057056; % H'
         [0 -1901592  2145000    40656 -1087515    76032   -34485] ./ 5285280; % I
         [0    42364    93925   178024   112710      648  -252890] ./ 680680;  % I'
%        [0        0  1098521                                    ] ./ 3920400; % K
 	 [0        0  0.28021 -0.62852 -0.082414 0.0088109 -4.9822e-05] ./ 1;  % K
%        [0        0  -595033                                    ] ./ 27442800;% K'
 	 [0        0 -0.021683 0.00050167 -0.30417 -0.48925 -0.18439] ./ 1;    % K'
         [0        0        0   -81396    62985   118336     9555] ./ 272272;  % L
         [0        0        0        0     -255      256      -33] ./ 544;     % M
         [0        0        0        0        0      -11       23] ./ 34;      % N
         [0        0        0        0        0        0       -1] ./ 1];      % O
%------------------------------------------------------------------------------%
%        [0   -51450   402038   137984    -1365     9072  -182875] ./ 784784;  % I
%        [0  9516192  -841568  2492336  9862125  -100800 -3869635] ./ 26682656;% I'
%       -[0 0 -118697579 616876876 1092831740 730219875 349489140] ./2908115210;%K
%     -[0 0 2560049856 -4088054124 105884415 2421693120 630194565] ./9805876080;%K'
%------------------------- Original entries of Wybourne -----------------------%

% (31)L' P           D           F           F'          G           H           H'          I           I'           L   U
% (31)L'  K           K'          L           M           N           O             L  U

% T6 is not complete! It has been partially reassembled from the tabulated cfp listed in 
%   C.W. Neilson and G.F. Koster, 1963.
% U'=(22) S           D           G           H           I            L           N              U=(31)
t6 = [   [0          27          -8           0           0            0           0] ./ 35;    % P
         [0        -720        -841        -364           0            0           0] ./ 1925;  % D
      [4455       -3432       -1664        1386       -1768            0           0] ./ 12705; % F
         [0          33       -1444           0         833            0           0] ./ 2310;  % F'
         [0        1485        -972       -4928       -4165            0           0] ./ 11550; % G
         [0        6630       62866      -34034      -28665        17955           0] ./ 150150;% H
         [0      133770         686       82654      -69615       -43605           0] ./ 330330;% H'
         [0           0        5600        -572       -4641       -14212           0] ./ 25025; % I
         [0           0       -2975      -19448       -2184          418           0] ./ 25025  % I'
         [0           0  8075/36179   -323/1771 [14592/2805 2583552/8645 -144669/323] ./ 1265]; % K
         [0           0      -17472      -50193      244944       -38896       -2695] ./ 354200;% K'
         [0           0           0   -171/3080     114/935   -5046/7315   -343/2584] ./ 1;     % L
         [0           0           0           0      -21/85       -12/95   1012/1615] ./ 1;     % M
         [0           0           0           0           0           49          46] ./ 95;    % N
         [0           0           0           0           0           -1          18] ./ 19];   % O
% U'=(22) S           D           G           H           I            L           N              U=(21)
t7 = [   [0      -13/77     208/385      -16/55           0            0           0] ./ 1;     % D
     [-1408       -2145       -1040       -6160       -1105            0           0] ./ 11858; % F
         [0        1485         -48       -1232        4165            0           0] ./ 6930;  % G
         [0       -4095      121296       -6864       46410      -206720           0] ./ 385385;% H
         [0           0        1008         572        4459         8976        8580] ./ 23595; % K
         [0           0           0        1020         315        -1360        6468] ./ 9163]; % L

% Tables from ACRY program of Allison et al. (Comp. Phys. Comm. vol 8, p 246-256, 1974)
% Expressed in rational form by guesswork and using the reciprocity relations (Judd 1963, p180, eq 7-37)
% (31)L' P           D           F           F'          G           H           H'          I           I'           L   U
acry1 = [0           0           0           0           0           0           0           0           0;         % S  (00)
         0           0           0           0           0           0           0           0           0;         % F  (10)
         0           0           0           0           0           0           0           0           0;         % P  (11)
         0           0           0           0           0           0           0           0           0;         % H
         0           0           0           0           0           0           0           0           0;         % D  (20)
         0           0           0           0           0           0           0           0           0;         % G
         0           0           0           0           0           0           0           0           0;         % I
        -26/315      104/693    -256/4455   -52/405      52/315     -221/630     13/198      0           0;         % D  (21)
         65/882      260/14553   160/693     0           520/4851    1105/15876  143/2268   -26/2079    -884/2079;  % F  (21)
         11/1134     100/1701   -416/8019    32/729      8/105  -22627/1326780 -10201/37908 [-182    -6188]./110565;% G
         0          -200/7623    0           4/33        4/15015     119/3510   6241/378378 [-6728     272]./24255; % H
         0           0           0           0          -112/2145    119/3510   -11/702      17/275     -32/2475;   % K
         0           0           0           0           0          -35/1326     289/42042   25/1323     800/22491; % L
         0           13/63      -1/27        143/432     143/336     0           0           0           0;         % P  (30)
        -11/336      7/72        0           11/48      -7/48       -187/6048    125/864     49/180     -17/360;    % F
        -143/1296   -13/1944    -700/8019    91/11664    13/240   [1493382 -113190]./7698240 1625/6804   1105/13608;% G
         0          -128/2079   -13/99      -1/144      -529/65520  -1309/10530 -1/2106     -1/270      -17/135;    % H
         0           0          -35/891     -35/4212    -5/468       0          -13/63      -169/2016    17/252;    % I
         0           0           0           0          -17/390     -539/7020   -425/9828   -8/1575     -0.0003361; % K
         0           0           0           0           0           0           0           11/6048     0.1035617; % M
         0           0          -1           0           0           0           0           0           0;         % S  (22)
        -33/175     -16/105      104/675    -11/1350     33/350     -187/4725   -49/135      0           0;         % D
         88/2835    -841/8505    1664/40095  722/3645   -6/175  -345763/1658475 -49/47385    32/243     -17/243;    % G
         0           52/1485     14/495      0           32/225     -187/2025    289/2835    52/4725     1768/4725; % H
         0           0           136/4455   -833/10530  -119/1170    77/1170     17/234     -17/225     -8/255;     % I
         0           0           0           0           0          -209/6630    19/546     -836/4725    418/80325; % L
         0           0           0           0           0           0           0           0           0;         % N
% (31)L' P           D           F           F'          G           H           H'          I           I'           L   U
         0           361/1365    5/9         3773/65520 -891/7280    0           0           0           0;         % P  (31)
        -361/2275   -36/5005     8/9900      7921/23400  13/56       68/819      1156/6435   0           0;         % D
         5/21       -2/3465     -52/165      0          -4/1155      85/378      11/54       1/2475      34/2475;   % F
         77/3120    -7921/32760  0           55/624      2809/21840  1309/56160 -6125/56160  4489/11700 -17/23400;  % F'
         297/7280    65/504      4/1485     -2809/28080 -121/1456   .1143465654 -.1143997899 13/900     -6137/23400;% G
         0          -340/9009    85/594      833/56160  -0.0935565   0.2067157  -0.1566655   0.0232471   0.0904265; % H
         0          -1156/14157  7/54       -8575/123552 0.0935993  -0.1566655  -0.0947963  -0.0080142   0.0092464; % H'
         0           0          -7/32175   -31423/152100 1/100      -0.0196701   0.0067812  -0.1199999   0.0631416; % I
         0           0          -238/32175   119/304200 -6137/33800 -0.0765131  -0.0078238   0.0631416   0.4938857; % I'
         0           0           0           0           0.0122390  -0.0621804   0.0007254   0.2218316   0.0002394; % K
         0           0           0           0          -0.0711289   0.0012829   0.2536230  -0.0131951   0.1321904; % K'
         0           0           0           0           0          -0.0952340   0.0065704   0.0882149  -0.0120363; % L
         0           0           0           0           0           0           0           0.1279779   0.0004977; % M
         0           0           0           0           0           0           0           0           0;         % N
         0           0           0           0           0           0           0           0           0];        % O
%-------------------------------------------------------------------------------------------------------------------%
%        65/882      260/14553   160/693     0           520/4851    1105/15876  143/2268   -4160/14553 -2210/14553;% F  (21)
%        11/1134     100/1701   -416/8019    32/729      8/105  -22627/1326780 -10201/37908 -64/1701    -34/1701;   % G
%        0          -200/7623    0           4/33        4/15015     119/3510   6241/378378 -64/693      136/693;   % H
%        0           0           0           0          -112/2145    119/3510   -11/702      34/3465    -5/77;      % K
%        0           0           0           0           0          -35/1326     289/42042   10/189      5/3213;    % L
%       -143/1296   -13/1944    -700/8019    91/11664    13/240     22627/116640 -343/23328  28717/95256 -221/11907;% G  (30)
%------------------------------------- Reciprocal of original Wybourne values --------------------------------------%

% (31)L'  K           K'          L           M           N           O             L  U
acry2 = [ 0           0           0           0           0           0;          % S  (00)
          0           0           0           0           0           0;          % F  (10)
          0           0           0           0           0           0;          % P  (11)
          0           0           0           0           0           0;          % H
          0           0           0           0           0           0;          % D  (20)
          0           0           0           0           0           0;          % G
          0           0           0           0           0           0;          % I
          0           0           0           0           0           0;          % D  (21)
          0           0           0           0           0           0;          % F
        -5168/266409 -3200/8073   0           0           0           0;          % G
         -10336/43953 1600/161161 -20672/77077 0          0           0;          % H
         -1900/29601  544/8073   -2176/57915  133/405    -44/135      0;          % K
     -655220/8219211 -3040/131859 640/4851    95/1071     20/153     -1472/3213;  % L
          0           0           0           0           0           0;          % P  (30)
          0           0           0           0           0           0;          % F
         -0.1902636   0.0147228   0           0           0           0;          % G
         -0.3491774   0.0002787   323/1716    0           0           0;          % H
          0.0387415   0.1429865   1615/13104  1045/3744   0           0;          % I
          0.0035896  -0.1993240  -7396/36855  1672/6885   847/4590    0;          % K
         -0.0000160  -0.0593081  -35/2736    -121/4896   -1771/5814  -253/513;    % M
          0           0           0           0           0           0;          % S  (22)
          0           0           0           0           0           0;          % D
        -40375/266409 104/3105    0           0           0           0;          % G
         -1615/15939 -507/6440    323/9240    0           0           0;          % H
       -4864/2516085 -486/1495    38/585      1463/9945   0           0;          % I
     -861184/10140585 286/7245   -1682/5985   44/765      3773/14535  253/8721;   % L
          6889/66861  11/4968    -539/12312  -11132/48195 506/2565   -506/1197;   % N
          0           0           0           0           0           0;          % P  (31)
          0           0           0           0           0           0;          % D
          0           0           0           0           0           0;          % F
          0           0           0           0           0           0;          % F'
         -0.0203967   0.1185490   0           0           0           0;          % G
         -0.0847935   0.0017494   0.1471759   0           0           0;          % H
          0.0009893   0.3458498  -0.0101542   0           0           0;          % H'
         -0.2559594   0.0152247   0.1153571  -0.1870488   0           0;          % I
         -0.0002762  -0.1525282  -0.0157396  -0.0007275   0           0;          % I'
         -0.0089932   0.0789138  -0.4459995  -0.1652895   0.0035878   0;          % K
          0.0789138   0.2912542  -0.0033336   0.0700938   0.0849833   0;          % K'
          0.3935290   0.0029414   0.0421070   0.0416478   0.2300826   0.0876399;  % L
         -0.1304917   0.0553372  -0.0372638  -0.1642860   0.3378153  -0.1463274;  % M
         -0.0025627  -0.0607023   0.1862573  -0.3056425   0.1787854   0.2660497;  % N
          0           0          -0.0647773  -0.1208791  -0.2429150   4/7      ]; % O
%---------------------------------------------------------------------------------%
%  -1364656/3972969 -26112/361179 0           0           0           0;          % G  (21)
%        -608/13377   9792/49049 -20672/77077 0           0           0;          % H
%     -12920/441441 15488/120393 -2176/57915  133/405    -44/135      0;          % K
%    -125000/147147 -12160/682227 640/4851    95/1071     20/153     -1472/3213;  % L
%-------------------- Reciprocal of original Wybourne values ---------------------%

% U'                                        (30)                                               L  U
% L'      P           F           G           H           I           K           M
acry3 = [ 0          -1           0           0           0           0           0;         % S  (40)
         [104        -21          91          64]./280    0           0           0;         % D
        [-143         231         91          11         -140]./616   0           0;         % F
          0.2149471  -0.0113636   0.5547979  -0.0330586   5/66        0.1100751   0;         % G
          0.1860269   0.2458678  -0.0710285   0.3348485   0.1338056   0.0284228   0;         % G'
          0           0.4772727  -0.0318182  -0.2461538  -0.0324675   0.2122877   0;         % H
          0          -0.1607264   0.0278592  -0.3300248   0.4701247   0.0042860  -0.0069789; % I
          0           0.2223791   0.3323828  -0.1035416  -0.0032372  -0.2946984   0.0437608; % I'
          0           0           0.5298702   0.1961538   0.0219156   0.0025856  -0.2494748; % K
          0           0           0           0.5961539   0.0388825   0.1283650   0.2365987; % L
          0           0           0           0           0.6129032  -0.3700190   0.0170778; % L'
          0           0           0           0           0.4910714   0.2773109  -0.2316176; % M
          0           0           0           0           0           0.6764705   0.3235294; % N
          0           0           0           0           0           0           1];        % Q

acry4a = [
% P          D          F          F'         G          H          H'         I          I'         K          K          L (31)'     L   U
  0          0          0         -1          0          0          0          0          0          0          0          0;        % S (40)
 -0.0010582 -0.2328042 -0.2353909  0.1729424 -0.0699735 -0.2878307  0          0          0          0          0          0;        % D
 -0.0800264 -0.1212522  0         -0.2268518  0.0823112 -0.0755805  0.3536523  0.0593715  0.0009540  0          0          0;        % F
 -0.1940280  0.0001796  0.0634050 -0.0592776 -0.2574969 -0.0227818 -0.0477904  0.1646132  0.0186910  0.0370462 -0.1346902  0;        % G
  0.0641289 -0.1904435 -0.0857408 -0.1133592 -0.1713992  0.0044139 -0.0001744 -0.0888366  0.0197596 -0.1970326 -0.0647111  0;        % G'
  0          0.0987654  0          0.1473064 -0.1218467 -0.1377651 -0.0159182 -0.2586019  0.0348886  0.0714463  0.0148656  0.0985959;% H
  0          0         -0.2471791 -0.0046653 -0.0138899  0          0.1920779  0.1374647 -0.0035082  0.1101082  0.0098998  0.2599370;% I
  0          0         -0.0775497 -0.0041012  0.1693204  0.1619183 -0.0314331 -0.0853047  0.0524322  0.1792547 -0.1479586 -0.0059868;% I'
  0          0          0          0         -0.0105672 -0.1838557  0.0126848 -0.1914394 -0.2457522  0.1705613  0.0148673 -0.0263148;% K
  0          0          0          0          0          0.0691978  0.0003610  0.0006166  0.2683544  0.2912561 -0.0101679 -0.2281106;% L
  0          0          0          0          0         -0.0485331 -0.2593052 -0.0681004  0.0721063  0.0053092  0.0639327  0.0276677;% L'
  0          0          0          0          0          0          0          0.0021825 -0.0831933 -0.0093072 -0.3039740 -0.2063840;% M
  0          0          0          0          0          0          0          0          0         -0.0006307  0.1512346  0.1506931;% N
  0          0          0          0          0          0          0          0          0          0          0          0];       % Q
acry4b = [
% M           N           O            L   U
  0           0           0;         % S  (40)
  0           0           0;         % D
  0           0           0;         % F
  0           0           0;         % G
  0           0           0;         % G'
  0           0           0;         % H
 -0.0212699   0           0;         % I
 -0.0847403   0           0;         % I'
 -0.0069565  -0.1370007   0;         % K
  0.0022533  -0.0003690  -0.1293134; % L
 -0.3626899   0.0830217  -0.0093339; % L'
 -0.2562364  -0.0164472   0.1222754; % M
 -0.2620569  -0.4075374  -0.0278474; % N
  0.0095238   0.3151515   0.6753247];% Q

acry5a = [
% S        D          F          G          G'         H          I          I'         K          L          L'         M  (40')    L   U
0         -0.2619047 -0.2291667 -0.2728175 -0.2361111  0          0          0          0          0          0          0;        % S  (22)
0.0604396  0.0226648  0.1586539  0.0061813 -0.1337413  0.3173077  0.1262850 -0.1747265  0          0          0          0;        % D
0          0.0763889 -0.0486111  0.2347222 -0.0300505  0.0164530  0.0170251  0.2031228 -0.3736264  0          0          0;        % G
0         -0.0439560  0.0048077  0.0114434 -0.1159091 -0.1041420  0.1650124  0.0517708  0.1131657 -0.3897929  0          0;        % H
0          0          0.0517752  0.0221894  0.0391916  0.0116230  0.1988989 -0.0013696 -0.0106984  0.0215119  0.3390914 -0.3036506;% I
0          0          0         -0.0279421 -0.0072150  0.0658636 -0.0015715  0.1080561  0.0010939 -0.0615494  0.1774194  0.1486102;% L
0          0          0          0          0          0          0.0020202 -0.0126676 -0.0833266 -0.0895627 -0.0064647 -0.0979921;% N
0          0          0          0          0          0          0          0          0          0          0          0;        % P  (30)
0          0          0          0          0          0          0          0          0          0          0          0;        % F
0          0          0          0          0          0          0          0          0          0          0          0;        % G
0          0          0          0          0          0          0          0          0          0          0          0;        % H
0          0          0          0          0          0          0          0          0          0          0          0;        % I
0          0          0          0          0          0          0          0          0          0          0          0;        % K
0          0          0          0          0          0          0          0          0          0          0          0;        % M
0          0.0018315 -0.1939102  0.6044719 -0.1997863  0          0          0          0          0          0          0;        % P  (31)
0         -0.2417582  0.1762820  0.0003358 -0.3559829 -0.2256410  0          0          0          0          0          0;        % D
0          0.1746032  0         -0.0846561  0.1144781  0          0.4767025  0.1495601  0          0          0          0;        % F
0.1483516 -0.1282814 -0.2355769  0.0791454  0.1513533  0.2403846  0.0089973  0.0079094  0          0          0          0;        % F'
0         -0.0403694 -0.0664821 -0.2674007 -0.1779914  0.1546516 -0.0208349  0.2539805  0.0182894  0          0          0;        % G
0          0.1358641 -0.0499466  0.0193566 -0.0037503 -0.1430638  0         -0.1987180 -0.2603550 -0.1110552  0.0778905  0;        % H
0          0          0.2337073  0.0406051  0.0001482 -0.0165305 -0.2357320  0.0385770  0.0179628 -0.0005794  0.4161577  0;        % H'
0          0         -0.0331988  0.1183462 -0.0638678  0.2272330  0.1427518 -0.0885856  0.2293874  0.0008373 -0.0924795 -0.0033126;% I
0          0         -0.0005334  0.0134376  0.0142059 -0.0306565 -0.0036431  0.0544488  0.2944664  0.3644221  0.0979194  0.1262667;% I'
0          0          0         -0.0230826  0.1227665  0.0544091 -0.0990973 -0.1613293  0.1771213 -0.3427860 -0.0062485 -0.0122425;% K
0          0          0          0.0839223  0.0403200  0.0113207 -0.0089098  0.1331628  0.0154391  0.0119668 -0.0752439 -0.3998427;% K'
0          0          0          0          0         -0.0662511  0.2064206 -0.0047543  0.0241120 -0.2368841  0.0287319  0.2395362;% L
0          0          0          0          0          0          0.0151128  0.0602102 -0.0057032 -0.0020937  0.3369932 -0.2660916;% M
0          0          0          0          0          0          0          0          0.1016214 -0.0003102  0.0697930  0.0154532;% N
0          0          0          0          0          0          0          0          0          0.0992556  0.0071643  0.1048951;% O
0          0         -1          0          0          0          0          0          0          0          0          0;        % S  (40)
0          0.2857143 -5/24       0.1238536 -0.1154321 -4/15       0          0          0          0          0          0;        % D
0.1428571  0.1488095 -1/24      -0.2381153 -0.0524691  1/12      -0.2242005  0.0685484  0          0          0          0;        % F
0          0.0688076  0.1852008 -0.0121252  0.2623457  0.0001319  0.0323687  0.3861841  0.0528361  0          0          0;        % G
0         -0.0641289  0.0408093  0.2623457  0.0196409  0.3453097 -0.2286827 -0.0000108  0.0390720  0          0          0;        % G'
0          4/33       0.0530303 -0.0001079 -0.2825261  0         -0.0835777  0.1566820 -0.1195887 -0.0011185 -0.1821565  0;        % H
0          0          0.1207234  0.0224091 -0.1583188  0.0707196 -0.1251951 -0.1120361 -0.0000893 -0.0403976  0.2540089  0.0961021;% I
0          0         -0.0369107  0.2673582 -0.0000075 -0.1325771 -0.1120361  0.0238388  0.1021749 -0.1826394  0.0092941 -0.1331633;% I'
0          0          0         -0.0317016 -0.0234432 -0.0876984  0.0000774 -0.0885516  0.4460784  0.2335244  0.0091903  0.0008131;% K
0          0          0          0          0          0.0007237 -0.0308923 -0.1396655 -0.2060509  0.2883281  0.0208117  0.1735057;% L
0          0          0          0          0          0.1178660  0.1942421  0.0071072 -0.0081091  0.0208117 -0.2290154  0.2473821;% L'
0          0          0          0          0          0         -0.0657541  0.0911117  0.0006419 -0.1552419 -0.2213419  0.0644855;% M
0          0          0          0          0          0          0          0          0.0563725  0.1133512 -0.1420442 -0.2982571;% N
0          0          0          0          0          0          0          0          0          0          0          0.0545455];%Q
acry5b = [
% N          Q     (40)'
 0           0;
 0           0;
 0           0;
 0           0;
 0           0;
-0.4006788   0;
-0.1512860  -0.5566801;
 0           0;
 0           0;
 0           0;
 0           0;
 0           0;
 0           0;
 0           0;
 0           0;
 0           0;
 0           0;
 0           0;
 0           0;
 0           0;
 0           0;
 0           0;
 0           0;
 0.0009169   0;
-0.2198718   0;
 0.1933099   0;
 0.3007820  -0.0130133;
-0.4232119   0.3896104;
 0.0264038  -0.7622812;
 0           0;
 0           0;
 0           0;
 0           0;
 0           0;
 0           0;
 0           0;
 0           0;
-0.0789216   0;
 0.1400221   0;
-0.1754663   0;
 0.3296526  -0.0717703;
 0.1208238   0.2691511;
 0.2260869   0.7193676];

t = [ t1 [zeros(4,7);t3;zeros(7,7)] ];
t = [ [t [zeros(7,7);t7;zeros(14,7)]]; [zeros(15,7) t4 t5 t6] ];
t = [ [t acry1 acry2; zeros(14,13) acry3 zeros(14,7) acry4a acry4b] [zeros(13,14); acry5a acry5b] ];

if U==[0 0]
  if L == 'S'; i = 1; else i = 0; end
elseif U==[1 0]
  if L == 'F'; i = 2; else i = 0; end
elseif U==[1 1]
  if L == 'P'; i = 3; elseif L == 'H'; i = 4; else; i = 0; end
elseif U==[2 0] 
  switch L
    case 'D'; i = 5;
    case 'G'; i = 6;
    case 'I'; i = 7;
  otherwise
    i = 0;
  end
elseif U==[2 1]
  switch L
    case 'D'; i = 8;
    case 'F'; i = 9;
    case 'G'; i = 10;
    case 'H'; i = 11;
    case 'K'; i = 12;
    case 'L'; i = 13;
  otherwise
    i = 0;
  end
elseif U==[3 0]
  switch L
    case 'P'; i = 14;
    case 'F'; i = 15;
    case 'G'; i = 16;
    case 'H'; i = 17;
    case 'I'; i = 18;
    case 'K'; i = 19;
    case 'M'; i = 20;
  otherwise
    i = 0;
  end
elseif U==[2 2]
  switch L
    case 'S'; i = 21;
    case 'D'; i = 22;
    case 'G'; i = 23;
    case 'H'; i = 24;
    case 'I'; i = 25;
    case 'L'; i = 26;
    case 'N'; i = 27;
  otherwise
    i = 0;
  end
elseif U==[3 1]         % Table IIbc from Uybourne
  switch L
    case 'P';  i = 28;
    case 'D';  i = 29;
    case 'F';  i = 30;
    case 'Fp'; i = 31;
    case 'G';  i = 32;
    case 'H';  i = 33;
    case 'Hp'; i = 34;
    case 'I';  i = 35;
    case 'Ip'; i = 36;
    case 'K';  i = 37;
    case 'Kp'; i = 38;
    case 'L';  i = 39;
    case 'M';  i = 40;
    case 'N';  i = 41;
    case 'O';  i = 42;
  otherwise
    i = 0;
  end
elseif U==[4 0]         % From ACRY program of Allison
  switch L
    case 'S';  i = 43;
    case 'D';  i = 44;
    case 'F';  i = 45;
    case 'G';  i = 46;
    case 'Gp'; i = 47;
    case 'H';  i = 48;
    case 'I';  i = 49;
    case 'Ip'; i = 50;
    case 'K';  i = 51;
    case 'L';  i = 52;
    case 'Lp'; i = 53;
    case 'M';  i = 54;
    case 'N';  i = 55;
    case 'Q';  i = 56;
  otherwise
    i = 0;
  end
else
  i = 0;
end

if Up==[0 0]
  if Lp == 'S'; j = 1; else j = 0; end
elseif Up==[1 0]
  if Lp == 'F'; j = 2; else j = 0; end
elseif Up==[1 1]
  if Lp == 'P'; j = 3; elseif Lp == 'H'; j = 4; else; j = 0; end
elseif Up==[2 0] 
  switch Lp
    case 'D'; j = 5;
    case 'G'; j = 6;
    case 'I'; j = 7;
  otherwise
    j = 0;
  end
elseif Up==[2 1]
  switch Lp
    case 'D'; j = 8;
    case 'F'; j = 9;
    case 'G'; j = 10;
    case 'H'; j = 11;
    case 'K'; j = 12;
    case 'L'; j = 13;
  otherwise
    j = 0;
  end
elseif Up==[3 0]
  switch Lp
    case 'P'; j = 14;
    case 'F'; j = 15;
    case 'G'; j = 16;
    case 'H'; j = 17;
    case 'I'; j = 18;
    case 'K'; j = 19;
    case 'M'; j = 20;
  otherwise
    j = 0;
  end
elseif Up==[2 2]
  switch Lp
    case 'S'; j = 21;
    case 'D'; j = 22;
    case 'G'; j = 23;
    case 'H'; j = 24;
    case 'I'; j = 25;
    case 'L'; j = 26;
    case 'N'; j = 27;
  otherwise
    j = 0;
  end
elseif Up==[3 1]         % Table IIbc from Uybourne
  switch Lp
    case 'P';  j = 28;
    case 'D';  j = 29;
    case 'F';  j = 30;
    case 'Fp'; j = 31;
    case 'G';  j = 32;
    case 'H';  j = 33;
    case 'Hp'; j = 34;
    case 'I';  j = 35;
    case 'Ip'; j = 36;
    case 'K';  j = 37;
    case 'Kp'; j = 38;
    case 'L';  j = 39;
    case 'M';  j = 40;
    case 'N';  j = 41;
    case 'O';  j = 42;
  otherwise
    j = 0;
  end
elseif Up==[4 0]        % From ACRY program of Allison
  switch Lp
    case 'S';  j = 43;
    case 'D';  j = 44;
    case 'F';  j = 45;
    case 'G';  j = 46;
    case 'Gp'; j = 47;
    case 'H';  j = 48;
    case 'I';  j = 49;
    case 'Ip'; j = 50;
    case 'K';  j = 51;
    case 'L';  j = 52;
    case 'Lp'; j = 53;
    case 'M';  j = 54;
    case 'N';  j = 55;
    case 'Q';  j = 56;
  otherwise
    j = 0;
  end
else
  j = 0;
end

if i~=0 & j~=0
  ulf = real(sqrt(t(i,j))) - imag(sqrt(t(i,j)));
else
  ulf = 0;
end
